from geopy.geocoders import Nominatim
import time
import pandas as pd

# β… μ§€μ¤μ½”λ” κ°μ²΄ μƒμ„±
geolocator = Nominatim(user_agent="geo_batch_geocoder")

# β… μ΅°νν•  λ„λ΅λ… μ£Όμ† λ¦¬μ¤νΈ
addresses = [
    "μ„μΈνΉλ³„μ‹ μ¤‘κµ¬ μƒλ¬Έμ•λ΅ 92",  # CBD-μ‹ λ¬Έλ΅μ§€μ—­(μ„μΈμ‹ λ¬Έμ‚¬)
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬ μ°μ •κµ­λ΅ 26",  # CBD-μ°μ •κµ­λ΅μ§€μ—­(μ› μ¤‘μ•™μ°μ²΄κµ­)
    "μ„μΈνΉλ³„μ‹ μ¤‘κµ¬ λ¬΄κµλ΅ 21",  # CBD-λ¬΄κµμ§€μ—­(SFC)
    "μ„μΈνΉλ³„μ‹ μ¤‘κµ¬ μ²­κ³„μ²λ΅ 100",  # CBD-μ²­κ³„μ§€μ—­(μ²­κ³„κ΄‘μ¥)
    "μ„μΈνΉλ³„μ‹ μ¤‘κµ¬ ν•κ°•λ€λ΅ 405",  # CBD-μ„μΈμ—­μ§€μ—­(μ„μΈμ—­)
    "μ„μΈνΉλ³„μ‹ μ¤‘κµ¬ λ‚¨λ€λ¬Έμ‹μ¥4κΈΈ 21",  # CBD-λ‚¨λ€λ¬Έμ§€μ—­(λ‚¨λ€λ¬Έμ‹μ¥ μ¤‘μ•™μƒκ°€)
    "μ„μΈνΉλ³„μ‹ μ¤‘κµ¬ λ…λ™κΈΈ 74",  # CBD-λ…λ™μ§€μ—­(λ…λ™ μ¤‘μ•™μƒκ°€)
    "μ„μΈνΉλ³„μ‹ μ¤‘κµ¬ μ„μ§€λ΅ 3κ°€ 100",  # CBD-κΈ°νƒ€μ§€μ—­(μ„μ§€λ΅3κ°€μ—­)
    "μ„μΈνΉλ³„μ‹ λ§ν¬κµ¬ λ§ν¬λ€λ΅ 109",  # YBD-λ§ν¬μ§€μ—­(λ§ν¬μ—­)
    "μ„μΈνΉλ³„μ‹ μλ“±ν¬κµ¬ μμ‚¬λ‹Ήλ€λ΅ 1",  # YBD-κµ­νμ•μ§€μ—­(κµ­νμμ‚¬λ‹Ή)
    "μ„μΈνΉλ³„μ‹ μλ“±ν¬κµ¬ κµ­μ κΈμµλ΅ 10",  # YBD-μ—¬μλ„μ¤‘μ•™μ§€μ—­(IFC)
    "μ„μΈνΉλ³„μ‹ μλ“±ν¬κµ¬ μ—¬μλ€λ΅ 66",  # YBD-μ¦κ¶κ±°λμ†μ§€μ—­(ν•κµ­κ±°λμ†)
    "μ„μΈνΉλ³„μ‹ μλ“±ν¬κµ¬ κ²½μΈλ΅ 846",  # YBD-μλ“±ν¬μ§€μ—­(μλ“±ν¬μ—­)
    "μ„μΈνΉλ³„μ‹ κ°•λ‚¨κµ¬",  # GBD-λ°©λ°°μ§€μ—­
    "μ„μΈνΉλ³„μ‹ κ°•λ‚¨κµ¬",  # GBD-μ„μ΄μ§€μ—­
    "μ„μΈνΉλ³„μ‹ κ°•λ‚¨κµ¬",  # GBD-λ„μ‚°λ΅μ§€μ—­
    "μ„μΈνΉλ³„μ‹ κ°•λ‚¨κµ¬",  # GBD-μ—­μ‚Όλ¶λ¶€μ§€μ—­
    "μ„μΈνΉλ³„μ‹ κ°•λ‚¨κµ¬",  # GBD-μ„ λ¦‰λ¶λ¶€μ§€μ—­
    "μ„μΈνΉλ³„μ‹ κ°•λ‚¨κµ¬",  # GBD-μ‚Όμ„±λ¶λ¶€μ§€μ—­
    "μ„μΈνΉλ³„μ‹ κ°•λ‚¨κµ¬",  # GBD-μ—­μ‚Όλ‚¨λ¶€μ§€μ—­
    "μ„μΈνΉλ³„μ‹ κ°•λ‚¨κµ¬",  # GBD-μ„ λ¦‰λ‚¨λ¶€μ§€μ—­
    "μ„μΈνΉλ³„μ‹ κ°•λ‚¨κµ¬",  # GBD-μ‚Όμ„±λ‚¨λ¶€μ§€μ—­
    "μ„μΈνΉλ³„μ‹ κ°•λ‚¨κµ¬",  # GBD-μ–‘μ¬μ§€μ—­
    "μ„μΈνΉλ³„μ‹ κ°•λ‚¨κµ¬",  # GBD-μ†΅νμ§€μ—­
    "μ„μΈνΉλ³„μ‹ κ°•λ‚¨κµ¬",  # Others-μ¶©μ •λ΅μ§€μ—­
    "μ„μΈνΉλ³„μ‹ κ°•λ‚¨κµ¬",  # Others-λ…Έμ›μ§€μ—­
    "μ„μΈνΉλ³„μ‹ κ°•λ‚¨κµ¬",  # Others-λ™λ€λ¬Έμ„±λ™μ§€μ—­
    "μ„μΈνΉλ³„μ‹ κ°•λ‚¨κµ¬",  # Others-μ©μ‚°μ§€μ—­
    "μ„μΈνΉλ³„μ‹ κ°•λ‚¨κµ¬",  # Others-κ°•μ„λ©λ™μ§€μ—­
    "μ„μΈνΉλ³„μ‹ κ°•λ‚¨κµ¬",  # Others-κµ¬λ΅μ§€μ—­
    "μ„μΈνΉλ³„μ‹ κ°•λ‚¨κµ¬",  # Others-μ‚¬λ‹Ήμ§€μ—­
    "μ„μΈνΉλ³„μ‹ κ°•λ‚¨κµ¬",  # Others-μ²νΈμ§€μ—­
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬",  # λ„μ‹¬
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬",  # κ°•λ‚¨
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬",  # μ—¬μλ„λ§ν¬
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬",  # κΈ°νƒ€
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬",  # CBD-κ΄‘ν™”λ¬Έ
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬",  # CBD-λ™λ€λ¬Έ
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬",  # CBD-λ…λ™
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬",  # CBD-μΆ…λ΅
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬",  # CBD-μ¶©λ¬΄λ΅
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬",  # GBD-κ°•λ‚¨λ€λ΅
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬",  # GBD-λ„μ‚°λ€λ΅
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬",  # GBD-μ„μ΄
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬",  # GBD-ν…ν—¤λ€λ΅
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬",  # YBD-κ³µλ•μ—­
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬",  # YBD-μ—¬μλ„
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬",  # YBD-μλ“±ν¬
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬",  # Others-λ©λ™
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬",  # Others-μ‚¬λ‹Ή
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬",  # Others-μ©μ‚°
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬",  # Others-μ μ‹¤
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬",  # Others-μ¥μ•λ™
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬",  # Others-μ²νΈ
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬",  # Others-ν™”κ³΅
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬",  # GBD-λ…Όν„μ—­
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬",  # GBD-μ‹ μ‚¬μ—­
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬",  # CBD-λ‚¨λ€λ¬Έ
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬",  # CBD-μ‹μ²­
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬",  # CBD-μ„μ§€λ΅
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬",  # GBD-κµλ€μ—­
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬",  # GBD-λ‚¨λ¶€ν„°λ―Έλ„
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬",  # YBD-λ‹Ήμ‚°μ—­
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬",  # YBD-μλ“±ν¬μ—­
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬",  # Others-μ™λ…μ—¬λ€
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬",  # Others-μ©μ‚°μ—­
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬",  # Others-μ μ‹¤/μ†΅ν
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬",  # Others-μ μ‹¤μƒλ‚΄μ—­
    "μ„μΈνΉλ³„μ‹ μΆ…λ΅κµ¬"  # Others-ν™λ€/ν•©μ •
]

# β… κ²°κ³Ό μ €μ¥μ© λ¦¬μ¤νΈ
geo_data = []

# β… μ£Όμ†λ³„ μ„λ„/κ²½λ„ λ³€ν™
for address in addresses:
    try:
        location = geolocator.geocode(address)
        if location:
            lat, lon = location.latitude, location.longitude
            print(f"π“ {address} β†’ μ„λ„ {lat}, κ²½λ„ {lon}")
            geo_data.append([address, lat, lon])
        else:
            print(f"β {address} β†’ μ„μΉλ¥Ό μ°Ύμ„ μ μ—†μµλ‹λ‹¤.")
            geo_data.append([address, None, None])
    except Exception as e:
        print(f"β οΈ μ¤λ¥ λ°μƒ: {address} β†’ {e}")
        geo_data.append([address, None, None])

    time.sleep(0.1)  # API νΈμ¶ μ ν• λ°©μ§€λ¥Ό μ„ν•΄ 0.1μ΄ λ€κΈ°

# β… λ³€ν™λ λ°μ΄ν„°λ¥Ό DataFrameμΌλ΅ μ €μ¥
geo_df = pd.DataFrame(geo_data, columns=["μ£Όμ†", "μ„λ„", "κ²½λ„"])

# β… CSV νμΌλ΅ μ €μ¥ (ν•„μ” μ‹)
geo_df.to_csv("λ„λ΅λ…μ£Όμ†_μ„λ„κ²½λ„.csv", encoding="utf-8-sig", index=False)

print("β… λ¨λ“  μ£Όμ†μ μ„λ„/κ²½λ„ λ³€ν™ μ™„λ£! CSV μ €μ¥ μ™„λ£.")